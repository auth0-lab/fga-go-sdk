# Go SDK for Auth0 Fine Grained Authorization (FGA)

[![FOSSA Status](https://app.fossa.com/api/projects/custom%2B4989%2Fgithub.com%2Fauth0-lab%2Ffga-go-sdk.svg?type=shield)](https://app.fossa.com/projects/custom%2B4989%2Fgithub.com%2Fauth0-lab%2Ffga-go-sdk?ref=badge_shield)

This is an autogenerated Go SDK for Auth0 Fine Grained Authorization (FGA). It provides a wrapper around the [Auth0 Fine Grained Authorization API](https://docs.fga.dev/api/service).

Warning: This SDK comes with no SLAs and is not production-ready!

## Table of Contents

- [About Auth0 Fine Grained Authorization (FGA)](#about)
- [Resources](#resources)
- [Installation](#installation)
- [Getting Started](#getting-started)
  - [Initializing the API Client](#initializing-the-api-client)
  - [Getting your Store ID, Client ID and Client Secret](#getting-your-store-id-client-id-and-client-secret)
  - [Calling the API](#calling-the-api)
    - [Write Authorization Model](#write-authorization-model)
    - [Read a Single Authorization Model](#read-a-single-authorization-model)
    - [Read Authorization Model IDs](#read-authorization-model-ids)
    - [Check](#check)
    - [Write Tuples](#write-tuples)
    - [Delete Tuples](#delete-tuples)
    - [Expand](#expand)
    - [Read](#read)
    - [Read Changes (Watch)](#read-changes-watch)
  - [API Endpoints](#api-endpoints)
  - [Models](#models)
- [Contributing](#contributing)
  - [Issues](#issues)
  - [Pull Requests](#pull-requests) [Note: We are not accepting Pull Requests at this time!]
- [License](#license)

## <a id="about"></a>About Auth0 Fine Grained Authorization (FGA)

[Auth0 Fine Grained Authorization (FGA)](https://fga.dev) is an open source Fine-Grained Authorization solution inspired by [Google's Zanzibar paper](https://research.google/pubs/pub48190/). It was created by the FGA team at [Auth0](https://auth0.com) based on [Auth0 Fine-Grained Authorization (FGA)](https://fga.dev), available under [a permissive license (Apache-2)](https://github.com/auth0-lab/rfcs/blob/main/LICENSE) and welcomes community contributions.

Auth0 Fine Grained Authorization (FGA) is designed to make it easy for application builders to model their permission layer, and to add and integrate fine-grained authorization into their applications. Auth0 Fine Grained Authorization (FGA)’s design is optimized for reliability and low latency at a high scale.

It allows in-memory data storage for quick development, as well as pluggable database modules - with initial support for PostgreSQL.

It offers an [HTTP API](https://docs.fga.dev/api) and has SDKs for programming languages including [Node.js/JavaScript](https://github.com/auth0-lab/js-sdk), [GoLang](https://github.com/auth0-lab/go-sdk) and [.NET](https://github.com/auth0-lab/dotnet-sdk).

More SDKs and integrations such as Rego are planned for the future.

## Resources

- [Auth0 Fine Grained Authorization (FGA) Documentation](https://docs.fga.dev)
- [Auth0 Fine Grained Authorization (FGA) API Documentation](https://docs.fga.dev/api)
- [Twitter](https://twitter.com/auth0-lab)
- [Auth0 Fine Grained Authorization (FGA) Discord Community](https://discord.gg/8naAwJfWN6)
- [Zanzibar Academy](https://zanzibar.academy)
- [Google's Zanzibar Paper (2019)](https://research.google/pubs/pub48190/)

## Installation

To install:

```
go get -u github.com/auth0-lab/fga-go-sdk
```

In your code, import the module and use it:

```go
import "github.com/auth0-lab/fga-go-sdk"

func Main() {
	configuration, err := auth0fga.NewConfiguration(auth0fga.UserConfiguration{})
}
```

You can then run

```shell
go mod tidy
```

to update `go.mod` and `go.sum` if you are using them.

## Getting Started

### Initializing the API Client

```golang

import (
    auth0fga "github.com/auth0-lab/fga-go-sdk"
    "os"
)

func Main() {
    // See https://github.com/auth0-lab/fga-go-sdk#getting-your-store-id-client-id-and-client-secret
    configuration, err := auth0fga.NewConfiguration(auth0fga.Configuration{
        Environment:  os.Getenv("AUTH0_FGA_ENVIRONMENT"), // can be: "us"/"staging"/"playground"
        StoreId:      os.Getenv("AUTH0_FGA_STORE_ID"),
        ClientId:     os.Getenv("AUTH0_FGA_CLIENT_ID"), // Required for all environments except playground
        ClientSecret: os.Getenv("AUTH0_FGA_CLIENT_SECRET"), // Required for all environments except playground
    })

    if err != nil {
    // .. Handle error
    }

    apiClient := auth0fga.NewAPIClient(configuration)
}
```


### Getting your Store ID, Client ID and Client Secret

#### Production

Make sure you have created your credentials on the Auth0 FGA Dashboard. [Learn how ➡](https://docs.fga.dev/intro/dashboard#create-api-credentials)

You will need to set the `AUTH0_FGA_ENVIRONMENT` variable to `"us"`. Provide the store id, client id and client secret you have created on the Dashboard.

#### Playground

If you are testing this on the public playground, you need to set your `AUTH0_FGA_ENVIRONMENT` to `"playground"`.

To get your store id, you may copy it from the store you have created on the [Playground](https://play.fga.dev). [Learn how ➡](https://docs.fga.dev/intro/playground#getting-store-id)

In the playground environment, you do not need to provide a client id and client secret.

### Calling the API

#### Write Authorization Model

[API Documentation](https://docs.fga.dev/api#/Store%20Models/WriteAuthorizationModel)

> Note: To learn how to build your authorization model, check the Docs at https://docs.fga.dev.

> Learn more about [the Auth0 Fine Grained Authorization (FGA) configuration language](https://docs.fga.dev/modeling/configuration-language).

```golang
body  := auth0fga.TypeDefinitions{TypeDefinitions: &[]auth0fga.TypeDefinition{
	{
		Type: "repo",
		Relations: map[string]auth0fga.Userset{
			"writer": {This: &map[string]interface{}{}},
			"reader": {Union: &auth0fga.Usersets{
				Child: &[]auth0fga.Userset{
					{This: &map[string]interface{}{}},
					{ComputedUserset: &auth0fga.ObjectRelation{
						Object:   auth0fga.PtrString(""),
						Relation: auth0fga.PtrString("writer"),
					}},
				},
			}},
		},
	},
}}
data, response, err := apiClient.Auth0FgaApi.WriteAuthorizationModel(context.Background()).Body(body).Execute()

fmt.Printf("%s", data.AuthorizationModelId) // 1uHxCSuTP0VKPYSnkq1pbb1jeZw
```

#### Read a Single Authorization Model

[API Documentation](https://docs.fga.dev/api#/Store%20Models/ReadAuthorizationModel)

```golang
// Assuming `1uHxCSuTP0VKPYSnkq1pbb1jeZw` is an id of a single model
data, response, err := apiClient.Auth0FgaApi.ReadAuthorizationModel(context.Background(), "1uHxCSuTP0VKPYSnkq1pbb1jeZw").Execute()

// data = {"authorization_model":{"id":"1uHxCSuTP0VKPYSnkq1pbb1jeZw","type_definitions":[{"type":"repo","relations":{"writer":{"this":{}},"reader":{ ... }}}]}} // JSON

fmt.Printf("%s", data.AuthorizationModel.Id) // 1uHxCSuTP0VKPYSnkq1pbb1jeZw
```

#### Read Authorization Model IDs

[API Documentation](https://docs.fga.dev/api#/Store%20Models/ReadAuthorizationModels)

```golang
data, response, err := apiClient.Auth0FgaApi.ReadAuthorizationModels(context.Background()).Execute()

// data = {"authorization_model_ids":["1uHxCSuTP0VKPYSnkq1pbb1jeZw","GtQpMohWezFmIbyXxVEocOCxxgq"]} // in JSON

fmt.Printf("%s", (*data.AuthorizationModelIds)[0]) // 1uHxCSuTP0VKPYSnkq1pbb1jeZw
```

#### Check

[API Documentation](https://docs.fga.dev/api#/Tuples/Check)

> Provide a tuple and ask the Auth0 Fine Grained Authorization (FGA) API to check for a relationship

```golang
body := auth0fga.CheckRequest{
	TupleKey: &auth0fga.TupleKey{
		User: auth0fga.PtrString("81684243-9356-4421-8fbf-a4f8d36aa31b"),
		Relation: auth0fga.PtrString("admin"),
		Object: auth0fga.PtrString("workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6"),
	},
}
data, response, err := apiClient.Auth0FgaApi.Check(context.Background()).Body(body).Execute()

// data = {"allowed":true,"resolution":""} // in JSON

fmt.Printf("%t", *data.Allowed) // True

```

#### Write Tuples

[API Documentation](https://docs.fga.dev/api#/Tuples/Write)

```golang
body := auth0fga.WriteRequest{
	Writes: &auth0fga.TupleKeys{
		TupleKeys: []auth0fga.TupleKey{
			{
				User: auth0fga.PtrString("81684243-9356-4421-8fbf-a4f8d36aa31b"),
				Relation: auth0fga.PtrString("admin"),
				Object: auth0fga.PtrString("workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6"),
			},
		},
	},
}
_, response, err := apiClient.Auth0FgaApi.Write(context.Background()).Body(body).Execute()

```

#### Delete Tuples

[API Documentation](https://docs.fga.dev/api#/Tuples/Write)

```golang
body := auth0fga.WriteRequest{
	Deletes: &auth0fga.TupleKeys{
		TupleKeys: []auth0fga.TupleKey{
			{
				User: auth0fga.PtrString("81684243-9356-4421-8fbf-a4f8d36aa31b"),
				Relation: auth0fga.PtrString("admin"),
				Object: auth0fga.PtrString("workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6"),
			},
		},
	},
}
_, response, err := apiClient.Auth0FgaApi.Write(context.Background()).Body(body).Execute()

```

#### Expand

[API Documentation](https://docs.fga.dev/api#/Debugging/Expand)

```golang
body := auth0fga.ExpandRequest{
	TupleKey: &auth0fga.TupleKey{
		Relation: auth0fga.PtrString("admin"),
		Object: auth0fga.PtrString("workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6"),
	},
}
data, response, err := apiClient.Auth0FgaApi.Expand(context.Background()).Body(body).Execute()

// data = {"tree":{"root":{"name":"workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6#admin","leaf":{"users":{"users":["anne","beth"]}}}}} // JSON
```

#### Read

[API Documentation](https://docs.fga.dev/api#/Tuples/Read)

```golang
// Find if a relationship tuple stating that a certain user is an admin on a certain workspace
body := auth0fga.ReadRequest{
    TupleKey: &auth0fga.TupleKey{
        User:     auth0fga.PtrString("81684243-9356-4421-8fbf-a4f8d36aa31b"),
        Relation: auth0fga.PtrString("admin"),
        Object:   auth0fga.PtrString("workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6"),
    },
}

// Find all relationship tuples where a certain user has a relationship as any relation to a certain workspace
body := auth0fga.ReadRequest{
    TupleKey: &auth0fga.TupleKey{
        User:     auth0fga.PtrString("81684243-9356-4421-8fbf-a4f8d36aa31b"),
        Object:   auth0fga.PtrString("workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6"),
    },
}

// Find all relationship tuples where a certain user is an admin on any workspace
body := auth0fga.ReadRequest{
    TupleKey: &auth0fga.TupleKey{
        User:     auth0fga.PtrString("81684243-9356-4421-8fbf-a4f8d36aa31b"),
        Relation: auth0fga.PtrString("admin"),
        Object:   auth0fga.PtrString("workspace:"),
    },
}

// Find all relationship tuples where any user has a relationship as any relation with a particular workspace
body := auth0fga.ReadRequest{
    TupleKey: &auth0fga.TupleKey{
        Object:   auth0fga.PtrString("workspace:675bcac4-ad38-4fb1-a19a-94a5648c91d6"),
    },
}

data, response, err := apiClient.Auth0FgaApi.Read(context.Background()).Body(body).Execute()

// In all the above situations, the response will be of the form:
// data = {"tuples":[{"key":{"user":"...","relation":"...","object":"..."},"timestamp":"..."}]} // JSON
```

#### Read Changes (Watch)

[API Documentation](https://docs.fga.dev/api#/Tuples/ReadChanges)

```golang
data, response, err := apiClient.Auth0FgaApi.ReadChanges(context.Background()).
    Type_("workspace").
    PageSize(25).
    ContinuationToken("eyJwayI6IkxBVEVTVF9OU0NPTkZJR19hdXRoMHN0b3JlIiwic2siOiIxem1qbXF3MWZLZExTcUoyN01MdTdqTjh0cWgifQ==").
    Execute()

// response.continuation_token = ...
// response.changes = [
//   { tuple_key: { user, relation, object }, operation: "write", timestamp: ... },
//   { tuple_key: { user, relation, object }, operation: "delete", timestamp: ... }
// ]
```


### API Endpoints

Class | Method | HTTP request | Description
------------ | ------------- | ------------- | -------------
*Auth0FgaApi* | [**Check**](docs/Auth0FgaApi.md#check) | **Post** /stores/{store_id}/check | Check whether a user is authorized to access an object
*Auth0FgaApi* | [**Expand**](docs/Auth0FgaApi.md#expand) | **Post** /stores/{store_id}/expand | Expand all relationships in userset tree format, and following userset rewrite rules.  Useful to reason about and debug a certain relationship
*Auth0FgaApi* | [**Read**](docs/Auth0FgaApi.md#read) | **Post** /stores/{store_id}/read | Get tuples from the store that matches a query, without following userset rewrite rules
*Auth0FgaApi* | [**ReadAssertions**](docs/Auth0FgaApi.md#readassertions) | **Get** /stores/{store_id}/assertions/{authorization_model_id} | Read assertions for an authorization model ID
*Auth0FgaApi* | [**ReadAuthorizationModel**](docs/Auth0FgaApi.md#readauthorizationmodel) | **Get** /stores/{store_id}/authorization-models/{id} | Return a particular version of an authorization model
*Auth0FgaApi* | [**ReadAuthorizationModels**](docs/Auth0FgaApi.md#readauthorizationmodels) | **Get** /stores/{store_id}/authorization-models | Return all the authorization model IDs for a particular store
*Auth0FgaApi* | [**ReadChanges**](docs/Auth0FgaApi.md#readchanges) | **Get** /stores/{store_id}/changes | Return a list of all the tuple changes
*Auth0FgaApi* | [**Write**](docs/Auth0FgaApi.md#write) | **Post** /stores/{store_id}/write | Add or delete tuples from the store
*Auth0FgaApi* | [**WriteAssertions**](docs/Auth0FgaApi.md#writeassertions) | **Put** /stores/{store_id}/assertions/{authorization_model_id} | Upsert assertions for an authorization model ID
*Auth0FgaApi* | [**WriteAuthorizationModel**](docs/Auth0FgaApi.md#writeauthorizationmodel) | **Post** /stores/{store_id}/authorization-models | Create a new authorization model


### Models

 - [Any](docs/Any.md)
 - [Assertion](docs/Assertion.md)
 - [AuthErrorCode](docs/AuthErrorCode.md)
 - [AuthenticationErrorMessageResponse](docs/AuthenticationErrorMessageResponse.md)
 - [AuthorizationModel](docs/AuthorizationModel.md)
 - [CheckRequest](docs/CheckRequest.md)
 - [CheckResponse](docs/CheckResponse.md)
 - [Computed](docs/Computed.md)
 - [ContextualTupleKeys](docs/ContextualTupleKeys.md)
 - [CreateStoreResponse](docs/CreateStoreResponse.md)
 - [Difference](docs/Difference.md)
 - [ErrorCode](docs/ErrorCode.md)
 - [ExpandRequest](docs/ExpandRequest.md)
 - [ExpandResponse](docs/ExpandResponse.md)
 - [GetStoreResponse](docs/GetStoreResponse.md)
 - [InternalErrorCode](docs/InternalErrorCode.md)
 - [InternalErrorMessageResponse](docs/InternalErrorMessageResponse.md)
 - [Leaf](docs/Leaf.md)
 - [ListStoresResponse](docs/ListStoresResponse.md)
 - [Node](docs/Node.md)
 - [Nodes](docs/Nodes.md)
 - [NotFoundErrorCode](docs/NotFoundErrorCode.md)
 - [ObjectRelation](docs/ObjectRelation.md)
 - [PathUnknownErrorMessageResponse](docs/PathUnknownErrorMessageResponse.md)
 - [ReadAssertionsResponse](docs/ReadAssertionsResponse.md)
 - [ReadAuthorizationModelResponse](docs/ReadAuthorizationModelResponse.md)
 - [ReadAuthorizationModelsResponse](docs/ReadAuthorizationModelsResponse.md)
 - [ReadChangesResponse](docs/ReadChangesResponse.md)
 - [ReadRequest](docs/ReadRequest.md)
 - [ReadResponse](docs/ReadResponse.md)
 - [ResourceExhaustedErrorCode](docs/ResourceExhaustedErrorCode.md)
 - [ResourceExhaustedErrorMessageResponse](docs/ResourceExhaustedErrorMessageResponse.md)
 - [Status](docs/Status.md)
 - [Store](docs/Store.md)
 - [Tuple](docs/Tuple.md)
 - [TupleChange](docs/TupleChange.md)
 - [TupleKey](docs/TupleKey.md)
 - [TupleKeys](docs/TupleKeys.md)
 - [TupleOperation](docs/TupleOperation.md)
 - [TupleToUserset](docs/TupleToUserset.md)
 - [TypeDefinition](docs/TypeDefinition.md)
 - [TypeDefinitions](docs/TypeDefinitions.md)
 - [Users](docs/Users.md)
 - [Userset](docs/Userset.md)
 - [UsersetTree](docs/UsersetTree.md)
 - [UsersetTreeDifference](docs/UsersetTreeDifference.md)
 - [UsersetTreeTupleToUserset](docs/UsersetTreeTupleToUserset.md)
 - [Usersets](docs/Usersets.md)
 - [ValidationErrorMessageResponse](docs/ValidationErrorMessageResponse.md)
 - [WriteAssertionsRequest](docs/WriteAssertionsRequest.md)
 - [WriteAuthorizationModelResponse](docs/WriteAuthorizationModelResponse.md)
 - [WriteRequest](docs/WriteRequest.md)


## Contributing

### Issues

If you have found a bug or if you have a feature request, please report them at this repository [issues](https://github.com/auth0-lab/fga-go-sdk/issues) section. Please do not report security vulnerabilities on the public GitHub issue tracker.

### Pull Requests

Pull Requests are not currently open, please [raise an issue](https://github.com/auth0-lab/fga-go-sdk/issues) or contact a team member on https://discord.gg/8naAwJfWN6 if there is a feature you'd like us to implement.

## Author

[Auth0 FGA](https://github.com/auth0-lab)

## License

This project is licensed under the MIT license. See the [LICENSE](https://github.com/auth0-lab/fga-go-sdk/blob/main/LICENSE) file for more info.

The code in this repo was auto generated by [OpenAPI Generator](https://github.com/OpenAPITools/openapi-generator) from a template based on the [go template](https://github.com/OpenAPITools/openapi-generator/tree/master/modules/openapi-generator/src/main/resources/go), licensed under the [Apache License 2.0](https://github.com/OpenAPITools/openapi-generator/blob/master/LICENSE).

This repo bundles some code from the [golang.org/x/oauth2](https://pkg.go.dev/golang.org/x/oauth2) package. You can find the code [here](./oauth2) and corresponding [BSD-3 License](./oauth2/LICENSE).
